package com.zensar.emdb.dao;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.*;

import com.zensar.emdb.connection.DBUtil;

public class daoClass implements daoInterface<Boolean, Employee>{
			Connection c =DBUtil.getConnection();
			String query;
			boolean status = false;
			int eCode;
			String eName;
			String designation;
			int age ;
			double basicPay;
			double DA;
			double HRA;
			double salary;
			
			//insert function 
			public Boolean insert(Employee obj) {
				
				status = false;
				//Access variable
				eCode = obj.geteCode();
				eName = obj.geteName();
				designation = obj.getDesignation();
				age = obj.getAge(); 
				basicPay = obj.getBasicPay();
					
					  
				try {
					query = "insert into sample values(?,?,?,?,?)";
					PreparedStatement pst = c.prepareStatement(query);
					pst.setInt(1, eCode);		
					pst.setString(2, eName);
					pst.setString(3, designation);
					pst.setInt(4, age);
					pst.setDouble(5, basicPay);
					int count= pst.executeUpdate();
					
					DA = basicPay* 0.2;
					HRA = basicPay * 0.1;
					salary = basicPay + DA + HRA;
					query = "insert into EmployeeSalary values(?,?,?,?,?,?,?)";
					pst.setInt(1, eCode);
					pst.setString(2, eName);
					pst.setString(3, designation);
					pst.setDouble(5, basicPay);
					int count= pst.executeUpdate();
					
					if(count > 0){
							//if inserted succuessfully then set status 
							status= true;
					}
					} catch (SQLException e) {
						e.printStackTrace();
					}
					return status;
					
				} //end of insert function
			
			//showMySalary function
			public boolean showMySalary(Employee obj) {
				status = false;
				eCode = obj.geteCode();
				
				Statement stmt = c.createStatement();
				query = "select Ecode, Ename,Designation ,Basic_pay, DA , HRA, salary from EmployeeSalary where Ecode = ?"; 
				stmt.setInt(1,eCode);
				ResultSet rst = stmt.executeQuery(query);
				
				while(rst.next()) {
					status = true;
					eName = rst.getString(2);
					designation = rst.getString(3);
					basicPay = rst.getDouble(4);
					DA = rst.getDouble(5);
					HRA = rst.getDouble(6);
					salary = rst.getDouble(7);
				}
				return status;
			}//end of function
			
}
